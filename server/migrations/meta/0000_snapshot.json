{
  "version": "6",
  "dialect": "sqlite",
  "id": "b3dd9fc1-5412-4d81-871b-2005e7b5b005",
  "prevId": "00000000-0000-0000-0000-000000000000",
  "tables": {
    "article_word_index": {
      "name": "article_word_index",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "word": {
          "name": "word",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "article_id": {
          "name": "article_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "context_snippet": {
          "name": "context_snippet",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "role": {
          "name": "role",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        }
      },
      "indexes": {
        "idx_awi_word": {
          "name": "idx_awi_word",
          "columns": [
            "word"
          ],
          "isUnique": false
        },
        "idx_awi_article_id": {
          "name": "idx_awi_article_id",
          "columns": [
            "article_id"
          ],
          "isUnique": false
        },
        "uq_awi_word_article": {
          "name": "uq_awi_word_article",
          "columns": [
            "word",
            "article_id"
          ],
          "isUnique": true
        }
      },
      "foreignKeys": {
        "article_word_index_article_id_articles_id_fk": {
          "name": "article_word_index_article_id_articles_id_fk",
          "tableFrom": "article_word_index",
          "tableTo": "articles",
          "columnsFrom": [
            "article_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {
        "chk_awi_role_enum": {
          "name": "chk_awi_role_enum",
          "value": "\"article_word_index\".\"role\" IN ('keyword', 'entity')"
        }
      }
    },
    "articles": {
      "name": "articles",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "generation_task_id": {
          "name": "generation_task_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "model": {
          "name": "model",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "variant": {
          "name": "variant",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "title": {
          "name": "title",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "content_json": {
          "name": "content_json",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        },
        "published_at": {
          "name": "published_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        }
      },
      "indexes": {
        "uq_articles_unique": {
          "name": "uq_articles_unique",
          "columns": [
            "generation_task_id",
            "model"
          ],
          "isUnique": true
        },
        "idx_articles_generation_task_id": {
          "name": "idx_articles_generation_task_id",
          "columns": [
            "generation_task_id"
          ],
          "isUnique": false
        },
        "idx_articles_status": {
          "name": "idx_articles_status",
          "columns": [
            "status"
          ],
          "isUnique": false
        },
        "idx_articles_published": {
          "name": "idx_articles_published",
          "columns": [
            "published_at"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "articles_generation_task_id_tasks_id_fk": {
          "name": "articles_generation_task_id_tasks_id_fk",
          "tableFrom": "articles",
          "tableTo": "tasks",
          "columnsFrom": [
            "generation_task_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {
        "chk_articles_status_enum": {
          "name": "chk_articles_status_enum",
          "value": "\"articles\".\"status\" IN ('draft', 'published')"
        },
        "chk_articles_content_json_valid": {
          "name": "chk_articles_content_json_valid",
          "value": "json_valid(\"articles\".\"content_json\")"
        }
      }
    },
    "daily_words": {
      "name": "daily_words",
      "columns": {
        "date": {
          "name": "date",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "new_words_json": {
          "name": "new_words_json",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "review_words_json": {
          "name": "review_words_json",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {
        "chk_daily_words_new_words_json_valid": {
          "name": "chk_daily_words_new_words_json_valid",
          "value": "json_valid(\"daily_words\".\"new_words_json\")"
        },
        "chk_daily_words_review_words_json_valid": {
          "name": "chk_daily_words_review_words_json_valid",
          "value": "json_valid(\"daily_words\".\"review_words_json\")"
        }
      }
    },
    "generation_profiles": {
      "name": "generation_profiles",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "topic_preference": {
          "name": "topic_preference",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "concurrency": {
          "name": "concurrency",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timeout_ms": {
          "name": "timeout_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        }
      },
      "indexes": {
        "uq_generation_profiles_name": {
          "name": "uq_generation_profiles_name",
          "columns": [
            "name"
          ],
          "isUnique": true
        },
        "idx_generation_profiles_topic_preference": {
          "name": "idx_generation_profiles_topic_preference",
          "columns": [
            "topic_preference"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {
        "chk_generation_profiles_concurrency_gt0": {
          "name": "chk_generation_profiles_concurrency_gt0",
          "value": "\"generation_profiles\".\"concurrency\" > 0"
        },
        "chk_generation_profiles_timeout_ms_gt0": {
          "name": "chk_generation_profiles_timeout_ms_gt0",
          "value": "\"generation_profiles\".\"timeout_ms\" > 0"
        }
      }
    },
    "highlights": {
      "name": "highlights",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "article_id": {
          "name": "article_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "actor": {
          "name": "actor",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "start_meta_json": {
          "name": "start_meta_json",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "end_meta_json": {
          "name": "end_meta_json",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "text": {
          "name": "text",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "note": {
          "name": "note",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "style_json": {
          "name": "style_json",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        },
        "deleted_at": {
          "name": "deleted_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        }
      },
      "indexes": {
        "idx_highlights_article_id": {
          "name": "idx_highlights_article_id",
          "columns": [
            "article_id"
          ],
          "isUnique": false
        },
        "idx_highlights_actor": {
          "name": "idx_highlights_actor",
          "columns": [
            "actor"
          ],
          "isUnique": false
        },
        "idx_highlights_article_actor": {
          "name": "idx_highlights_article_actor",
          "columns": [
            "article_id",
            "actor"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "highlights_article_id_articles_id_fk": {
          "name": "highlights_article_id_articles_id_fk",
          "tableFrom": "highlights",
          "tableTo": "articles",
          "columnsFrom": [
            "article_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {
        "chk_highlights_start_meta_json_valid": {
          "name": "chk_highlights_start_meta_json_valid",
          "value": "json_valid(\"highlights\".\"start_meta_json\")"
        },
        "chk_highlights_end_meta_json_valid": {
          "name": "chk_highlights_end_meta_json_valid",
          "value": "json_valid(\"highlights\".\"end_meta_json\")"
        },
        "chk_highlights_style_json_valid": {
          "name": "chk_highlights_style_json_valid",
          "value": "\"highlights\".\"style_json\" IS NULL OR json_valid(\"highlights\".\"style_json\")"
        }
      }
    },
    "tasks": {
      "name": "tasks",
      "columns": {
        "id": {
          "name": "id",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "task_date": {
          "name": "task_date",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "trigger_source": {
          "name": "trigger_source",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'manual'"
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "profile_id": {
          "name": "profile_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "result_json": {
          "name": "result_json",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "error_context_json": {
          "name": "error_context_json",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "version": {
          "name": "version",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": 0
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        },
        "started_at": {
          "name": "started_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "finished_at": {
          "name": "finished_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "published_at": {
          "name": "published_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        }
      },
      "indexes": {
        "idx_tasks_task_date": {
          "name": "idx_tasks_task_date",
          "columns": [
            "task_date"
          ],
          "isUnique": false
        },
        "idx_tasks_type": {
          "name": "idx_tasks_type",
          "columns": [
            "type"
          ],
          "isUnique": false
        },
        "idx_tasks_status": {
          "name": "idx_tasks_status",
          "columns": [
            "status"
          ],
          "isUnique": false
        },
        "idx_tasks_profile_id": {
          "name": "idx_tasks_profile_id",
          "columns": [
            "profile_id"
          ],
          "isUnique": false
        },
        "idx_tasks_published_at": {
          "name": "idx_tasks_published_at",
          "columns": [
            "published_at"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "tasks_profile_id_generation_profiles_id_fk": {
          "name": "tasks_profile_id_generation_profiles_id_fk",
          "tableFrom": "tasks",
          "tableTo": "generation_profiles",
          "columnsFrom": [
            "profile_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {
        "chk_tasks_type_enum": {
          "name": "chk_tasks_type_enum",
          "value": "\"tasks\".\"type\" IN ('article_generation')"
        },
        "chk_tasks_trigger_source_enum": {
          "name": "chk_tasks_trigger_source_enum",
          "value": "\"tasks\".\"trigger_source\" IN ('manual', 'cron')"
        },
        "chk_tasks_status_enum": {
          "name": "chk_tasks_status_enum",
          "value": "\"tasks\".\"status\" IN ('queued', 'running', 'succeeded', 'failed', 'canceled')"
        },
        "chk_tasks_result_json_valid": {
          "name": "chk_tasks_result_json_valid",
          "value": "\"tasks\".\"result_json\" IS NULL OR json_valid(\"tasks\".\"result_json\")"
        },
        "chk_tasks_error_context_json_valid": {
          "name": "chk_tasks_error_context_json_valid",
          "value": "\"tasks\".\"error_context_json\" IS NULL OR json_valid(\"tasks\".\"error_context_json\")"
        },
        "chk_tasks_published_only_for_article_generation": {
          "name": "chk_tasks_published_only_for_article_generation",
          "value": "\"tasks\".\"type\" = 'article_generation' OR \"tasks\".\"published_at\" IS NULL"
        }
      }
    },
    "words": {
      "name": "words",
      "columns": {
        "word": {
          "name": "word",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "origin": {
          "name": "origin",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "origin_ref": {
          "name": "origin_ref",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(CURRENT_TIMESTAMP)"
        }
      },
      "indexes": {
        "idx_words_origin": {
          "name": "idx_words_origin",
          "columns": [
            "origin"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {
        "chk_words_origin_enum": {
          "name": "chk_words_origin_enum",
          "value": "\"words\".\"origin\" IN ('shanbay', 'article', 'manual')"
        }
      }
    }
  },
  "views": {},
  "enums": {},
  "_meta": {
    "schemas": {},
    "tables": {},
    "columns": {}
  },
  "internal": {
    "indexes": {}
  }
}