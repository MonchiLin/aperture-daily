---
/**
 * 每日文章列表 - Astro 版本
 * 
 * 纯服务端渲染，完整输出文章列表 HTML。
 */
interface Article {
    id: string;
    model: string;
    title: string;
}

interface WordData {
    new_words: string[];
    review_words: string[];
    new_count: number;
    review_count: number;
}

import WordsDrawer from "@/components/WordsDrawer";
import AdminDrawer from "@/components/AdminDrawer";

interface Props {
    date: string;
    data: { articles: Article[] };
    wordData?: WordData;
}

const { date, data, wordData } = Astro.props;

// 格式化日期显示
const dateObj = new Date(date + 'T00:00:00');
const dayNum = dateObj.getDate();
const monthYear = dateObj.toLocaleString('en-US', { month: 'long', year: 'numeric' });
---

<div class="flex flex-col h-full font-serif text-slate-900">
    <!-- Compact Header -->
    <div class="border-b border-slate-900 mb-6 pb-2 flex items-baseline justify-between select-none">
        <h2 class="text-3xl font-bold tracking-tight text-slate-900 leading-none">
            {dayNum} <span class="text-xl font-normal italic text-stone-500 ml-1">{monthYear}</span>
        </h2>
        <div class="flex items-center gap-4">
            <WordsDrawer client:idle date={date} wordData={wordData} />
            <AdminDrawer client:idle date={date} />
        </div>
    </div>

    <!-- Compact List -->
    <div class="flex-1">
        {data.articles && data.articles.length > 0 ? (
            <div class="flex flex-col">
                {data.articles.map((article, idx) => (
                    <article class="group relative border-b border-stone-200 last:border-0 hover:bg-stone-50 -mx-4 px-4 transition-colors cursor-pointer">
                        <a href={`/article/${article.id}`} class="flex items-baseline py-3 w-full gap-4">
                            {/* Number */}
                            <span class="text-xs font-bold text-stone-300 font-sans w-6 shrink-0 group-hover:text-stone-500 transition-colors">
                                {String(idx + 1).padStart(2, '0')}
                            </span>
                            
                            {/* Title */}
                            <h3 class="flex-1 font-serif text-lg font-medium text-slate-900 leading-tight group-hover:text-amber-900 transition-colors truncate pr-4">
                                {article.title}
                            </h3>
                            
                            {/* Arrow Icon (Only visible on hover) */}
                            <div class="shrink-0 self-center opacity-0 group-hover:opacity-100 transition-all transform -translate-x-2 group-hover:translate-x-0 text-stone-400">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4">
                                    <path fill-rule="evenodd" d="M3 10a.75.75 0 01.75-.75h10.638L10.23 5.29a.75.75 0 111.04-1.08l5.5 5.25a.75.75 0 010 1.08l-5.5 5.25a.75.75 0 11-1.04-1.08l4.158-3.96H3.75A.75.75 0 013 10z" clip-rule="evenodd" />
                                </svg>
                            </div>
                        </a>
                    </article>
                ))}
            </div>
        ) : (
            <div class="py-12 flex flex-col items-center justify-center text-stone-400 gap-2">
                <span class="font-serif italic text-base text-stone-500">No content.</span>
            </div>
        )}
    </div>
</div>
